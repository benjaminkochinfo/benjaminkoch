<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Insider Terminal — Briefings</title>
<meta name="description" content="Quiet, data-heavy briefs for resilient strategists.">
<meta name="robots" content="index,follow">
<style>
:root{ --bg:#0b0c0e; --panel:#121317; --grid:#1b1d22; --text:#e6e6ea; --muted:#b7bcc6; --blue:#1f77b4; --orange:#ff7f0e; }
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;user-select:none}
.header{position:sticky;top:0;z-index:10;border-bottom:1px solid var(--grid);background:rgba(11,12,14,.86);backdrop-filter:blur(8px)}
.container{max-width:1180px;margin:0 auto;padding:12px 16px}
.brand{display:flex;align-items:center;gap:12px}
.logo{height:40px;width:40px;border-radius:10px;border:1px solid var(--grid);display:grid;place-items:center;background:#0c0e12}
.title{line-height:1.05; position:relative; padding-top:8px;}
.title h1{margin:0;font-size:26px;font-weight:800;letter-spacing:-.01em;display:inline-block;position:relative}
.anywhere{letter-spacing:.12em;font-weight:700;font-size:12px;opacity:0.9;margin-left:8px}
.tagline{margin:2px 0 0 0;font-size:13px;opacity:.8}
.cursor-square{position:absolute;left:0;top:-6px;width:12px;height:12px;border-radius:2px;background:#1f77b4;box-shadow:0 0 10px rgba(31,119,180,.55);animation:blink 1s steps(1,end) infinite;outline:1px solid rgba(255,255,255,.25);outline-offset:-1px}
@keyframes blink{ 0%,49%{opacity:1} 50%,100%{opacity:0} }
.banner{border-bottom:1px solid var(--grid);background-image:linear-gradient(0deg,transparent 24px, rgba(255,255,255,.04) 25px),linear-gradient(90deg,transparent 24px, rgba(255,255,255,.04) 25px);background-size:25px 25px}
.panel{border:1px solid rgba(255,255,255,.08);background:var(--panel);border-radius:14px;box-shadow:0 0 0 1px rgba(255,255,255,.04),0 16px 40px rgba(0,0,0,.55);padding:14px}
.kicker{text-transform:uppercase;letter-spacing:.12em;font-size:10px;color:#9aa1ae}
.headline{color:var(--orange);font-size:20px;margin:4px 0 0 0;text-shadow:0 0 18px rgba(255,127,14,.18);font-weight:800}
.deck{color:#d6d6dc;font-size:14px;margin:6px 0 0 0}
.badge{display:inline-block;font-size:10px;padding:.12rem .42rem;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.04);color:#cfd3da;margin-right:6px}
.meta{display:flex;align-items:center;gap:8px;font-size:12px;opacity:.85;margin-top:6px;flex-wrap:wrap}
.prose{line-height:1.85;color:var(--text);font-size:16px;margin-top:10px;text-align:justify;text-justify:inter-word;hyphens:auto}
.prose p{margin:.6rem 0}
.grid{display:grid;gap:16px}
.posts{display:grid;grid-template-columns:1fr;align-items:start}
@media(min-width:900px){.posts{grid-template-columns:1fr 1fr}}
.charts-grid{display:grid;gap:12px;margin-top:10px}
@media(min-width:900px){.charts-grid{grid-template-columns:1fr 1fr}}
.chartwrap{height:380px}
@media(max-width:700px){.chartwrap{height:280px}}
canvas{display:block;background:rgba(17,17,19,.25);border-radius:10px;padding:8px;width:100%;height:100%}
footer{border-top:1px solid var(--grid);padding:20px 0;color:var(--muted);font-size:13px}
.error{position:fixed;right:12px;top:12px;max-width:520px;background:rgba(0,0,0,.88);color:#fff;padding:12px;border:1px solid #c33;border-radius:8px;font:12px ui-monospace,Consolas,monospace;display:none;z-index:9999;white-space:pre-wrap}
#archive .chips, #topic-chips {
  display:flex;
  flex-wrap:nowrap;
  overflow-x:auto;
  gap:8px;
  scrollbar-width:none;
}
#topic-chips::-webkit-scrollbar { display:none; }
#archive .chips{display:flex;flex-wrap:wrap;gap:8px}
#topic-chips{
  display:flex;
  flex-wrap:nowrap;
  gap:6px;
  overflow:hidden;
  align-items:center;
}
#topic-chips .badge{
  font-size:10px;
  white-space:nowrap;
}
#archive p.note{opacity:.85;font-size:13px;margin:6px 0 10px 0}
@media print{header,.banner,footer,#archive,#topic-chips{display:none !important}body{background:#fff;color:#000;user-select:text}canvas{height:440px}}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
<div id="err" class="error"></div>
<header class="header">
  <div class="container brand">
    <div class="logo" title="Insider Terminal">
      <svg viewBox="0 0 64 64" width="36" height="36" xmlns="http://www.w3.org/2000/svg" aria-label="IT">
        <rect x="2" y="2" width="60" height="60" rx="12" fill="#0b0d12"/>
        <text x="32" y="39" text-anchor="middle" font-family="Inter,system-ui,-apple-system,Segoe UI,Roboto,sans-serif" font-weight="800" font-size="28" fill="#1f77b4">IT</text>
        <circle cx="12" cy="12" r="2.4" fill="#ff7f0e" opacity=".85"/>
        <circle cx="52" cy="50" r="2.4" fill="#ff7f0e" opacity=".85"/>
      </svg>
    </div>
    <div class="title">
      <span class="cursor-square" aria-hidden="true"></span>
      <div style="display:flex;align-items:flex-end;gap:8px">
        <h1 id="brandInsider">Insider Terminal</h1>
        <span class="anywhere">ANYWHERE</span>
      </div>
      <p class="tagline">Briefings for resilient strategists.</p>
    </div>
  </div>
</header>
<div class="banner"><div class="container" style="color:#b7bcc6;font-size:14px">Daily briefs across markets, policy, psychology. Optimistic by default, grounded by design.</div></div>

<main class="container" style="padding:14px 16px">
  <section class="panel">
    <h2 class="section-title" style="font-size:18px;line-height:1.15">Today’s Edition <span id="datestamp" style="opacity:.8;font-weight:600"></span></h2>
    <p id="edition-sub" style="opacity:.9;font-size:14px;margin:6px 0 10px 0">An insider terminal blog since 2020 — clean, data-aware, and relentlessly constructive.</p>
    <div id="topic-chips" class="chips" style="margin:6px 0 8px 0"></div>
    <div id="sections"></div>
  </section>
</main>

<section id="archive" class="container" style="padding:0 16px 18px 16px">
  <div class="panel">
    <h3 class="section-title">Archive <span id="arcYears" style="opacity:.8"></span></h3>
    <div class="chips" id="archive-list"></div>
    <p class="note">Click a month to view a representative edition from that day.</p>
  </div>
</section>

<footer>
  <div class="container" style="display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap">
    <p>No affiliations. No mailing list. No noise.</p>
    <p>© 2025 Insider Terminal — Briefings. by Benjamin Koch</p>
  </div>
  <div class="container" style="font-size:12px;margin-top:6px">
    <strong>Disclaimer.</strong> This material is commentary for informational purposes only and does not constitute investment, legal, accounting, or tax advice; an offer to buy or sell any security, commodity or instrument; or a solicitation of any investment strategy. Information is believed reliable but is provided “as is” without warranties of completeness or accuracy. Opinions are subject to change. You are solely responsible for your decisions and compliance with applicable law. We disclaim all liability for any direct or consequential loss arising from use of this content.
  </div>
</footer>

<script>
// ==== error surface
const errBox = document.getElementById('err');
window.addEventListener('error', e => { errBox.style.display='block'; errBox.textContent='JS error: '+(e.message||e.error); });
window.addEventListener('unhandledrejection', e => { errBox.style.display='block'; errBox.textContent='Promise rejection: '+(e.reason && (e.reason.message||e.reason)); });

// ==== tiny helpers
const qs  = (s, r=document) => r.querySelector(s);
function rint(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }
function esc(s){ return (s||'').replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m])); }
function ensureWeekday(date){ const d=new Date(date),g=d.getDay(); if(g===0) d.setDate(d.getDate()-2); if(g===6) d.setDate(d.getDate()-1); return d; }
function randomCETDisplayString(dateObj){ const d=ensureWeekday(dateObj),startMin=390,endMin=1350,chosen=rint(startMin,endMin); const hh=('0'+Math.floor(chosen/60)).slice(-2),mm=('0'+(chosen%60)).slice(-2); const opts={ timeZone:'Europe/Berlin', year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit', hour12:false, timeZoneName:'short' }; const disp=new Intl.DateTimeFormat(undefined,opts).format(new Date(d.getFullYear()+'-'+('0'+(d.getMonth()+1)).slice(-2)+'-'+('0'+d.getDate()).slice(-2)+'T'+hh+':'+mm+':00')); return disp.replace(',', ''); }
function monthAxis(n,future){ const out=[],d=new Date(); for(let i=n-1;i>=-future;i--){ const dt=new Date(d.getFullYear(), d.getMonth()-i, 1); out.push(dt.toLocaleDateString(undefined,{month:'short',year:'2-digit'})); } return out; }
function rwalk(n,start,vol){ let v=start,out=[]; for(let i=0;i<n;i++){ v+=(Math.random()*2-1)*vol; out.push(+v.toFixed(2)); } return out; }
function withFutureSpace(series, future){ for(let i=0;i<future;i++) series.push(null); return series; }
function makeForecast(series, extra){ const n=series.length,k=Math.min(6,n-1),xs=[],ys=[]; for(let i=n-k;i<n;i++){ xs.push(i); ys.push(series[i]); } const mean=a=>a.reduce((x,y)=>x+y,0)/a.length; const mx=mean(xs), my=mean(ys); let num=0, den=0; for(let i=0;i<xs.length;i++){ num+=(xs[i]-mx)*(ys[i]-my); den+=(xs[i]-mx)**2; } const slope=den?num/den:0; const last=series[n-1]; const f=[]; for(let i=1;i<=extra;i++) f.push(+(last+slope*i).toFixed(2)); return f; }

// ==== chart sizing + plugins
function sizeCanvas(canvas){ const holder=canvas.parentElement||canvas; const w=holder.clientWidth||600; let h=Math.round(w*0.58); const isMobile=window.matchMedia('(max-width: 640px)').matches; h=Math.max(isMobile?240:300, Math.min(isMobile?420:560, h)); canvas.style.height=h+'px'; }
function gradientBlue(ctx){ const g=ctx.createLinearGradient(0,0,0,260); g.addColorStop(0,'rgba(31,119,180,0.35)'); g.addColorStop(1,'rgba(31,119,180,0.05)'); return g; }
const FutureShade = { id:'futureShade', beforeDatasetsDraw(chart){ const ca=chart.chartArea; if(!chart.scales||!chart.scales.x) return; const idx=chart.data.labels.length-6-0.5; const x=chart.scales.x.getPixelForValue(idx); if(!isFinite(x)) return; const ctx=chart.ctx; ctx.save(); ctx.fillStyle='rgba(255,255,255,0.035)'; ctx.fillRect(x, ca.top, Math.max(0, ca.right-x), ca.bottom-ca.top); ctx.restore(); } };
const LastPriceLine = { id:'lastPriceLine', afterDatasetsDraw(chart){ const ds=chart.data.datasets.find(d=>d._isPrice); if(!ds) return; let j=-1; for(let i=ds.data.length-1;i>=0;i--){ if(ds.data[i]!=null){ j=i; break; } } if(j<0) return; const meta=chart.getDatasetMeta(chart.data.datasets.indexOf(ds)), pt=meta.data[j], ctx=chart.ctx, ca=chart.chartArea; if(!pt) return; ctx.save(); ctx.setLineDash([4,4]); ctx.strokeStyle='rgba(255,255,255,0.35)'; ctx.beginPath(); ctx.moveTo(ca.left, pt.y); ctx.lineTo(ca.right, pt.y); ctx.stroke(); ctx.restore(); } };
const PriceTag = { id:'priceTag', afterDatasetsDraw(chart){ const ds=chart.data.datasets.find(d=>d._isPrice); if(!ds) return; let j=-1,val=null; for(let i=ds.data.length-1;i>=0;i--){ if(ds.data[i]!=null){ j=i; val=ds.data[i]; break; } } if(j<0) return; const meta=chart.getDatasetMeta(chart.data.datasets.indexOf(ds)), node=meta.data[j], y=node.y, ctx=chart.ctx, ca=chart.chartArea; const txt=String(val); ctx.save(); ctx.font='12px system-ui, -apple-system, Segoe UI, Roboto, sans-serif'; const w=ctx.measureText(txt).width+22, h=18, x=ca.right-w+1, yy=Math.max(ca.top+10, Math.min(ca.bottom-10, y-h/2)); ctx.fillStyle='#fff'; ctx.beginPath(); ctx.moveTo(x,yy); ctx.lineTo(x+w-10,yy); ctx.lineTo(x+w-10,yy+h); ctx.lineTo(x,yy+h); ctx.closePath(); ctx.fill(); ctx.beginPath(); ctx.moveTo(x+w-10,yy); ctx.lineTo(x+w,yy+h/2); ctx.lineTo(x+w-10,yy+h); ctx.closePath(); ctx.fill(); ctx.fillStyle='#111'; ctx.fillText(txt, x+8, yy+12.5); ctx.restore(); } };
function drawChart(canvas, spec){
  if(!window.Chart) return null;
  sizeCanvas(canvas);
  const ctx = canvas.getContext('2d');
  const datasets = [];
  datasets.push({ label: spec.title, data: spec.series[0].data, type:'line', borderWidth:2.2, tension:.25, pointRadius:0, spanGaps:false, borderColor:'rgba(31,119,180,0.95)', backgroundColor:gradientBlue(ctx), fill:true });
  datasets.push({ label: spec.title+' (price)', data: spec.series[1].data, type:'line', borderWidth:2, tension:.25, pointRadius:0, spanGaps:false, borderColor:'#ffffff', backgroundColor:'rgba(255,255,255,0)', fill:false, _isPrice:true });
  datasets.push({ label: spec.title+' (proj.)', data: spec.series[2].data, type:'line', borderWidth:1.6, tension:.25, pointRadius: spec.series[2].data.map((v,i,arr)=> i===arr.length-1 ? 5 : 0), pointStyle: spec.series[2].data.map((v,i,arr)=> i===arr.length-1 ? 'triangle' : 'circle'), spanGaps:false, borderColor:'rgba(255,255,255,0.9)', backgroundColor:'rgba(255,255,255,0.0)', fill:false, borderDash:[4,4] });
  const ch = new Chart(ctx, { type:'line', data: { labels: spec.labels, datasets }, options: { responsive:true, maintainAspectRatio:false, layout:{padding:{right:32}}, scales: { x: { ticks:{ color:'rgba(230,230,234,.9)' }, grid:{ color:'rgba(255,255,255,.08)' } }, y: { ticks:{ color:'rgba(230,230,234,.9)' }, grid:{ color:'rgba(255,255,255,.08)' } } }, plugins:{ legend:{ display:false }, tooltip:{ mode:'index', intersect:false } } }, plugins:[FutureShade,LastPriceLine,PriceTag]});
  return ch;
}

// ==== uniqueness tools
var __daySentences = new Set();
function splitSents(t){ const m=t.match(/[^.!?]+(?:[.!?]+|$)/g)||[]; return m.map(s=>s.trim()).filter(Boolean); }
function rewriteOnce(s,i){
  let out=s.replace(/\bpolicy\b/gi,'policy mix').replace(/\bcarry\b/gi,'carry income').replace(/\bliquidity\b/gi,'liquidity plumbing').replace(/\bvolatility\b/gi,'vol').replace(/\bnarratives?\b/gi,'stories').replace(/\boperators\b/gi,'hands').replace(/\bout(rage|rage)\b/gi,'indignation').replace(/\bdiscipline\b/gi,'rigor').replace(/\bpatience\b/gi,'forbearance').replace(/\bcentral banks?\b/gi,'the committee').replace(/\bquantitative tightening\b/gi,'QT').replace(/\bquantitative easing\b/gi,'QE').replace(/\bpivot\b/gi,'reset').replace(/\bpanic\b/gi,'hurry').replace(/\bcollapse\b/gi,'re-pricing').replace(/\boptimism\b/gi,'constructive bias');
  if(out.includes(';') && i%2===1){ const parts=out.split(';'); if(parts.length===2) out=parts[1].trim()+'. '+parts[0].trim()+'.'; }
  return out;
}
function uniquePara(text){
  const s = splitSents(text).map((x,i)=>{ let v=x, tries=0; while(__daySentences.has(v) && tries<6){ v=rewriteOnce(v,tries++);} __daySentences.add(v); return v; });
  return (s.length? s : ['Signals over spectacle.']).join(' ');
}

// ==== openers / deks
const OPENERS = [
  h=>`Ignore the theatrics; the incentive trail points here: ${h}.`,
  h=>`Under the noise floor, cash‑flow math rewrites the story: ${h}.`,
  h=>`When policy bluffs, the curve answers. Today’s answer: ${h}.`,
  h=>`Liquidity is a temperament test; the calm pass first: ${h}.`,
  h=>`Vol doesn’t vanish—it charges rent. The invoice reads: ${h}.`,
  h=>`Positioning is a mirror; today it stops lying: ${h}.`,
  h=>`Sequence first, spectacle last. The tape’s message: ${h}.`
];
const DEK_VERBS = {
  markets: ["maps incentives", "prices patience", "tests positioning", "rewards structure", "disciplines drama"],
  policy: ["moves cash‑flows", "quietly rewrites borders", "tightens collateral", "reopens channels", "narrows discretion"],
  behaviour: ["taxes impatience", "prices bias", "teaches forbearance", "punishes FOMO", "rewards sequencing"],
  energy: ["translates scarcity", "argues in barrels", "lets freight decide", "leans on storage", "pays crack spreads"],
  fx: ["listens to real yields", "steepens the story", "tests carry", "prices divergence", "favors liquidity"],
  housing: ["meets wages", "reopens credit boxes", "disciplines stories", "finds a behavioural floor", "normalizes issuance"],
  commodities: ["relearns gravity", "prices logistics", "reopens arbitrage", "normalizes supply", "compresses vol"],
  metals: ["flags scarcity", "prices forbearance", "tracks funding", "tests patience", "remembers basis"],
  coffee: ["tightens differentials", "listens to weather", "normalizes premiums", "keeps carry alive", "rewards hedgers"],
  agri: ["resets margins", "prices inputs", "moves with weather", "honors storage", "disciplines basis"],
  central: ["moves reserves", "re-maps collateral", "tightens the joints", "lets balance sheets speak", "prices discretion"]
};
function craftDek(title, sectionKey){
  const verbs = DEK_VERBS[sectionKey] || DEK_VERBS.markets;
  const pivot = title.split(':')[0].split('—')[0].split('-')[0].trim();
  return `${pivot} ${verbs[Math.floor(Math.random()*verbs.length)]} while the tape ignores applause.`;
}

// ==== diction pools per topic
const POOLS = {
  markets: [
    "Basis narrows as funding stops paying for panic; spreads compress where liquidity plumbing heals.",
    "Macro surprises fade and the variance migrates from headlines to allocation choices.",
    "Carry income is real only where the collateral stack is honest; elsewhere it's theatre with a tab.",
    "Term premia move like forbearance does: slowly, then convincingly.",
    "Cross‑asset confirms the message: stress leaks out of funding faster than it leaves social feeds.",
    "The vol surface votes with cash; you either respect it or donate.",
    "If you need cheerleaders to hold risk, you sized it wrong.",
    "Stop renting headlines; own the sequence and the basis that pays.",
    "Positioning still pretends to be conviction until real cash calls its bluff.",
    "Liquidity is a rented story; collateral is the owned one.",
    "When reflex funds chase heat, basis quietly invoices them.",
    "The curve is not a mood—it’s a schedule with teeth."
  ],
  policy: [
    "Supervision works like gravity—slow, constant, and indifferent to speeches.",
    "Collateral frameworks, not tweets, redraw cross‑border risk at the margin.",
    "Jurisdiction arbitrage is the quietest source of alpha; it's also the most durable.",
    "Policy trades one constraint for another; follow the plumbing, not the podium.",
    "When rules rewrite collateral, flows migrate before consensus notices.",
    "Tax regimes migrate faster than diplomats; basis trades follow.",
    "Supervision speaks in silence; the curve translates it.",
    "Policy does not create value; it rearranges liabilities and time."
  ],
  behaviour: [
    "Bias is a cost; markets extract it one impatience at a time.",
    "Momentum is a servant, not a thesis—don’t let it spend your cash.",
    "When correlations wobble, calm hands let time do the persuading.",
    "Rigor outperforms charisma when the tape haggles.",
    "The reflex is indignation; the edge is composure—twice over if needed.",
    "The reflex is indignation; the profit is restraint.",
    "Bias is the only leverage most hands can’t hedge.",
    "When the crowd narrates, price negotiates."
  ],
  energy: [
    "Inventories and freight set the conversation; opinions show up late and leave early.",
    "Products relearn cycles the way students learn discipline: slowly, then all at once.",
    "Tightness is arithmetic, not attitude; the curve knows.",
    "Crack spreads translate scarcity into schedules.",
    "Storage math vetoes drama; logistics price the patience.",
    "Barrels remember arithmetic after headlines forget.",
    "Inventory turns don’t care about applause.",
    "Refining margins tutor the impatient."
  ],
  fx: [
    "Growth divergence—not virtue—explains the dollar’s posture.",
    "Carry pays until jurisdiction says otherwise; then it presents the bill.",
    "Curve steepening isn’t a sermon—it’s a schedule.",
    "Real yields talk; crosses listen.",
    "Funding costs speak fluent FX; size the silence in between.",
    "Crosses don’t arbitrate virtue; they price funding.",
    "Carry is a tip jar until jurisdiction closes the bar.",
    "Real yields keep score when stories beg for mercy."
  ],
  housing: [
    "Affordability stabilizes where wages outrun rents; the floor is behavioural as much as financial.",
    "Credit boxes reopen from the edges; volumes follow with a lag.",
    "Permits are policy in practice; supply elasticity arrives with signatures, not slogans.",
    "Mortgage math disciplines stories better than editorials do.",
    "The floor forms where patience meets payrolls; watch permits, not posts.",
    "Builders obey rates; buyers obey paychecks; politicians obey polls.",
    "Credit boxes are reopening where reputations already did.",
    "Refis are a memory; amortization is the discipline."
  ],
  commodities: [
    "Logistics normalize; curves remember gravity.",
    "Softs trade weather maps, not myths; price the maps.",
    "Inventory math compresses vol the way supervision compresses tone.",
    "Arbitrage reopens and the noise gets priced out.",
    "Freight and storage arbitrate the argument; basis settles it.",
    "Storage vetoes speeches; logistics sentence the theatrics.",
    "Arb corridors reopen, and noise goes broke quietly."
  ],
  metals: [
    "Copper tests courage; gold prices forbearance; both remember funding first.",
    "Aluminium spreads flag scarcity the way quiet inventories do.",
    "As liquidity returns, nickel remembers how to behave.",
    "Refined versus mined tells you where the constraint lives.",
    "Metals reconnect with funding—again, and convincingly.",
    "Copper grades courage; gold grades forbearance.",
    "Paper claims wait for physical manners to return."
  ],
  coffee: [
    "Arabica remains tight as differentials repair; logistics finally cooperate.",
    "Sugar premiums fade when supply normalizes; the carry survives the drama.",
    "Softs keep listening to meteorology, not monologues.",
    "Weather trades money; weather maps trade edge.",
    "Arabica’s scarcity educates the impatient—twice if necessary.",
    "Softs punish wishful thinking with basis math.",
    "Weather is the only influencer that clears in cash."
  ],
  agri: [
    "Wheat resets margins on freight; corn watches inputs and learns.",
    "Yields surprise at the edges; soybeans catch a bid as basis narrows.",
    "Grains reconnect with weather—mercifully.",
    "Storage is policy for agriculture; it always was.",
    "Freight costs decide who earns carry and who narrates it.",
    "Hedgers farm volatility; tourists farm excuses.",
    "Freight lanes vote before analysts do."
  ],
  central: [
    "Balance sheets whisper what communiqués won’t admit.",
    "Reserves migrate while minutes distract.",
    "Collateral eligibility draws more borders than treaties.",
    "Liquidity is policy in practice; the press release is theatre.",
    "Reverse repos tell the truth when speeches won’t.",
    "The reset is a rumor; the plumbing is the fact.",
    "PEPP is a verb; QT is a temperament test.",
    "The discount window teaches more than conferences do."
  ]
};
const OPTIMISM = [
  "Stay constructive without being complacent.",
  "Harvest the easy basis and let the hard trades prove they deserve capital.",
  "Scale what works; starve what argues back.",
  "Keep risk sized to your sleep, not to the loudest story.",
  "Let the funding math veto the drama."
];
function craftParagraphs(headline, sectionKey){
  const open = OPENERS[Math.floor(Math.random()*OPENERS.length)](headline);
  const pool = POOLS[sectionKey] || POOLS.markets;
  const target = 16 + Math.floor(Math.random()*7); // 16..22
  const core = [...pool, ...pool, ...OPTIMISM].sort(()=>Math.random()-0.5);
  const parts = [open];
  while(parts.length < target && core.length){ parts.push(core.shift()); }
  parts.push("Bottom line: price first, story second; size to sleep, compound the habits that pay.");
  return parts.map(uniquePara);
}

// ==== sections + seeds
const SECTIONS=[
  { key:'markets', name:'Markets & Macro' },
  { key:'policy', name:'Policy & Jurisdiction' },
  { key:'behaviour', name:'Behaviour & Psychology' },
  { key:'energy', name:'Energy & Industry' },
  { key:'fx', name:'FX & Rates' },
  { key:'housing', name:'Housing & Credit' },
  { key:'commodities', name:'Commodities' },
  { key:'metals', name:'Metals' },
  { key:'coffee', name:'Coffee & Sugar' },
  { key:'agri', name:'Agriculture' },
  { key:'central', name:'Central Banking & Institutions' }
];
const SEEDS={
  markets:[ "Liquidity Learns To Breathe As Spreads Heal", "Positioning Confesses While Real Yields Blink", "Macro Turns Gradually, Then Convincingly" ],
  policy:[ "Supervision Nudges; The Policy Mix Reprices Time", "Collateral Rules Quietly Redraw The Map", "When Jurisdiction Moves, Capital Listens" ],
  behaviour:[ "Signal Over Spectacle: Bias Is Expensive", "When The Reflex Is Indignation, Structure Wins", "Patience Isn’t Passive; It’s Paid" ],
  energy:[ "ICE Brent 1st: Tightness Trains The Tape", "TTF Front‑Month: Storage Leads, Noise Trails", "Refining Rediscovers Cycles" ],
  fx:[ "Dollar Smile Widens; Carry Learns Manners", "Curve Steepening Rewrites The Crosses", "Real Yields Reassert Themselves" ],
  housing:[ "Housing Finds A Floor; Credit Stops Tightening", "Affordability Heals Where Incomes Outrun Rents", "Supply Elasticity Finally Arrives" ],
  commodities:[ "Curves Relearn Gravity As Logistics Normalize", "Softs Rally On Weather, Not Drama", "Inventories Reprice The Next Mile" ],
  metals:[ "Copper Tests Bearish Patience; Gold Holds Bid", "Aluminium Flags Scarcity; Nickel Normalizes", "Metals Reconnect With Funding" ],
  coffee:[ "Arabica Tightens As Differentials Repair", "Sugar Premiums Fade As Supply Normalizes", "Softs Ride Weather Maps, Not Headlines" ],
  agri:[ "Wheat Resets Margins; Freight Matters", "Corn Tracks Inputs; Yields Surprise", "Soybeans Catch A Bid As Freight Eases" ],
  central:[ "ECB Nudges Collateral; Dollar Liquidity Blinks", "The Fed’s Balance Sheet Talks Louder Than The FOMC", "BIS Silence Prices More Than A Speech" ]
};

// ==== topic charts
function makeTopicCharts(sectionKey){
  const months=60,future=6,labels=monthAxis(months,future), mk=(name,data)=>{
    const main=[...data], f=makeForecast(main,future), area=withFutureSpace([...main],future), price=withFutureSpace([...main],future), proj=Array(main.length).fill(null).concat(f);
    return { title:name, labels, future, base: main, series:[
      {name:name, type:'area', data: area},
      {name:name+' (price)', type:'line-solid', data: price, _isPrice:true},
      {name:name+' (proj.)', type:'line-dotted', data: proj}
    ]};
  };
  const base=rwalk(60,100,.22), infl=rwalk(60,2.6,.03), rate=rwalk(60,1.25,.02);
  const brent=rwalk(60,78,1.4), wti=rwalk(60,75,1.5), ttf=rwalk(60,40,.35), hub=rwalk(60,3.0,.18);
  const copper=rwalk(60,8800,32), gold=rwalk(60,2000,10), silver=rwalk(60,25,.25), aluminium=rwalk(60,2300,18), nickel=rwalk(60,18000,120);
  const arabica=rwalk(60,180,2.2), sugar=rwalk(60,20,.25), oj=rwalk(60,350,4.0), water=rwalk(60,60,.6), bdi=rwalk(60,1500,22);
  const dxy=rwalk(60,103,.6), eurusd=rwalk(60,1.08,.004), usdjpy=rwalk(60,155,.25), us10y=rwalk(60,4.1,.03), bund10y=rwalk(60,2.4,.02);
  switch(sectionKey){
    case 'markets': return [ mk('Composite Activity Index (2019=100)', base), mk('HICP YoY (%)', infl) ];
    case 'policy': return [ mk('Policy Rate Path Proxy (%)', rate), mk('Financial Conditions Index (z‑score)', base.map(v=>+((v-100)/5).toFixed(2))) ];
    case 'behaviour': return [ mk('Risk Appetite Proxy (Index)', base.map((v,i)=>+(v*(1+0.02*Math.sin(i/8))).toFixed(2))), mk('Sentiment Oscillator (Index)', base.map((v,i)=>+(100+10*Math.sin(i/4)).toFixed(2))) ];
    case 'energy': return [ mk('ICE Brent 1st ($/bbl)', brent), mk('WTI 1st ($/bbl)', wti), mk('TTF Gas 1st (€/MWh)', ttf) ];
    case 'fx': return [ mk('DXY Index', dxy), mk('EURUSD', eurusd), mk('USDJPY', usdjpy), mk('US 10Y Yield (%)', us10y), mk('DE 10Y Bund (%)', bund10y) ];
    case 'housing': return [ mk('Housing Activity (2019=100)', base), mk('Mortgage Rate Proxy (%)', base.map((v,i)=>+(2.5+0.02*i+0.2*Math.sin(i/7)).toFixed(2))) ];
    case 'commodities': return [ mk('Henry Hub 1st ($/MMBtu)', hub), mk('Baltic Dry Index', bdi), mk('Water Price Index (proxy)', water) ];
    case 'metals': return [ mk('LME Copper 3M (USD/t)', copper), mk('Gold Spot (USD/oz)', gold), mk('Silver Spot (USD/oz)', silver), mk('Aluminium 3M (USD/t)', aluminium), mk('Nickel 3M (USD/t)', nickel) ];
    case 'coffee': return [ mk('KC Arabica 1st (¢/lb)', arabica), mk('Sugar #11 1st (¢/lb)', sugar), mk('Frozen Concentrated Orange Juice (¢/lb)', oj) ];
    case 'agri': return [ mk('CBOT Wheat 1st (c/bu)', rwalk(60,600,6)), mk('CBOT Corn 1st (c/bu)', rwalk(60,500,5)), mk('CBOT Soybeans 1st (c/bu)', rwalk(60,1200,10)) ];
    case 'central': return [ mk('Fed Balance Sheet (proxy, $tn)', rwalk(60,8.2,0.06)), mk('ECB APP+PEPP (proxy, €tn)', rwalk(60,4.9,0.05)), mk('RRP Facility Usage (proxy, $bn)', rwalk(60,1200,15)), mk('Bank Reserves (proxy, $bn)', rwalk(60,3200,12)) ];
    default: return [ mk('Composite Activity Index (2019=100)', base), mk('HICP YoY (%)', infl) ];
  }
}

// ==== post synthesis + rendering
function craftDekLine(title, sectionKey){ return craftDek(title, sectionKey); }
function synthesizePost(seedTitle, dateObj, sectionKey){
  const tags=["Markets","Policy","Behaviour","Credit","Energy","FX","Housing","Supply Chain","Liquidity","Jurisdiction","Commodities","Metals","Softs","Agri","Central"];
  const charts = makeTopicCharts(sectionKey);
  let paragraphs = craftParagraphs(seedTitle, sectionKey);
  return { id:"p_"+Math.random().toString(36).slice(2,8), title:seedTitle, dek: craftDekLine(seedTitle, sectionKey), paragraphs, charts, published: randomCETDisplayString(dateObj), tag1: tags[Math.floor(Math.random()*tags.length)], tag2: tags[Math.floor(Math.random()*tags.length)], sectionKey };
}
function renderSection(container, sectionKey, dateObj){
  const seeds=SEEDS[sectionKey]||["Positioning is wrong again."], count=rint(1,2); // 1–2 per section
  for(let i=0;i<count;i++){
    const seed=seeds[Math.floor(Math.random()*seeds.length)], post=synthesizePost(seed, dateObj, sectionKey);
    const art=document.createElement('article'); art.className='panel grid'; art.id=post.id; art.dataset.section=sectionKey; art.dataset.charts=JSON.stringify(post.charts); art.dataset.title=post.title; art.dataset.dek=post.dek; art.dataset.published=post.published;
    art.innerHTML='<div class="kicker">'+(post.sectionKey.toUpperCase())+'</div>'
      +'<h3 class="headline">'+esc(post.title)+'</h3>'
      +'<p class="deck">'+esc(post.dek)+'</p>'
      +'<div class="meta"><span class="badge">'+esc(post.tag1)+'</span><span class="badge">'+esc(post.tag2)+'</span><span>•</span><time>'+post.published+'</time><button class="badge" style="margin-left:auto" data-print-id="'+post.id+'">Print Report</button></div>';
    const prose=document.createElement('div'); prose.className='prose'; prose.innerHTML=post.paragraphs.map(x=>'<p>'+esc(x)+'</p>').join('');
    art.appendChild(prose);
    const grid=document.createElement('div'); grid.className='charts-grid';
    post.charts.forEach(spec=>{
      const wrap=document.createElement('div'); wrap.className='chartwrap';
      const title=document.createElement('div'); title.style="font-size:12px;opacity:.8;margin:6px 0"; title.textContent=spec.title;
      const canvas=document.createElement('canvas'); wrap.appendChild(title); wrap.appendChild(canvas); grid.appendChild(wrap);
      setTimeout(()=> drawChart(canvas, spec), 0);
    });
    art.appendChild(grid);
    container.appendChild(art);
  }
}

// ==== print (per-article) + click delegation
function printArticleById(id){
  try{
    const art = document.getElementById(id);
    if(!art) throw new Error('Article not found: '+id);
    const title = art.dataset.title||'';
    const dek = art.querySelector('.deck')?.textContent||'';
    const published = art.dataset.published||'';
    const section = (art.dataset.section||'').toUpperCase();
    const paras = Array.from(art.querySelectorAll('.prose p')).map(p=>p.textContent);
    const win = window.open('', '_blank'); 
    if(!win) throw new Error('Popup blocked. Allow popups to print.');
    const doc = win.document;
    doc.write(`<!doctype html><html><head><meta charset="utf-8"><title>${title} — Report</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <style>
        body{font:14px system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;color:#000;margin:24px}
        h1{margin:0 0 6px 0;font-size:22px}
        h2{margin:0 0 12px 0;font-size:13px;color:#444;letter-spacing:.12em}
        .dek{margin:6px 0 10px 0;font-size:14px;color:#111}
        .meta{font-size:12px;color:#555;margin-bottom:10px}
        .prose{line-height:1.65;font-size:14.5px}
        .panel{border:1px solid #ccc;border-radius:10px;padding:16px}
        .grid{display:grid;gap:12px}
        canvas{display:block;width:100%;height:420px;background:#f7f7f9;border-radius:8px;padding:6px}
        @media print{ body{margin:12px} }
      </style>
      <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"><\/script>
    </head><body>
    <div class="panel">
      <h2>${section}</h2>
      <h1>${title}</h1>
      <div class="dek">${dek}</div>
      <div class="meta">${published}</div>
      <div class="prose">${paras.map(p=>`<p>${p}</p>`).join('')}</div>
      <div class="grid" id="chartHost"></div>
    </div>
    <script>
      function gradientBlue(ctx){ const g=ctx.createLinearGradient(0,0,0,260); g.addColorStop(0,'rgba(31,119,180,0.35)'); g.addColorStop(1,'rgba(31,119,180,0.05)'); return g; }
      function draw(spec){
        const wrap=document.createElement('div');
        const t=document.createElement('div'); t.textContent=spec.title; t.style.cssText='font-size:12px;opacity:.8;margin:6px 0';
        const c=document.createElement('canvas'); c.height=420; wrap.appendChild(t); wrap.appendChild(c); document.getElementById('chartHost').appendChild(wrap);
        const ctx=c.getContext('2d'); const datasets=[];
        datasets.push({ label: spec.title, data: spec.series[0].data, type:'line', borderWidth:2.2, tension:.25, pointRadius:0, spanGaps:false, borderColor:'rgba(31,119,180,0.95)', backgroundColor:gradientBlue(ctx), fill:true });
        datasets.push({ label: spec.title+' (price)', data: spec.series[1].data, type:'line', borderWidth:2, tension:.25, pointRadius:0, spanGaps:false, borderColor:'#111', backgroundColor:'rgba(0,0,0,0)', fill:false, _isPrice:true });
        datasets.push({ label: spec.title+' (proj.)', data: spec.series[2].data, type:'line', borderWidth:1.6, tension:.25, pointRadius:0, spanGaps:false, borderColor:'#333', backgroundColor:'rgba(0,0,0,0)', fill:false, borderDash:[4,4] });
        new Chart(ctx, { type:'line', data:{ labels: spec.labels, datasets }, options:{ responsive:false, maintainAspectRatio:false, layout:{padding:{right:32}}, scales:{ x:{ grid:{color:'#ddd'} }, y:{ grid:{color:'#eee'} } } } });
      }
      (JSON.parse(window.opener.document.getElementById('${id}').dataset.charts||'[]')).forEach(draw);
      setTimeout(()=>{ window.print(); }, 350);
    <\/script>
    </body></html>`);
    doc.close();
  }catch(e){ console.error(e); alert('Print error: '+(e.message||e)); }
}
document.addEventListener('click', ev=>{ const b=ev.target.closest('[data-print-id]'); if(b){ ev.preventDefault(); printArticleById(b.getAttribute('data-print-id')); }});

// ==== archive
function buildArchive(){
  const host=qs('#archive-list'); if(!host) return; host.innerHTML='';
  const now=new Date(); const startYear=2020;
  document.getElementById('arcYears').textContent='(2020–'+now.getFullYear()+')';
  for(let y=now.getFullYear(); y>=startYear; y--){
    for(let m=12;m>=1;m-=3){
      const date=new Date(y,m-1,15);
      const b=document.createElement('button'); b.className='badge'; b.style.cursor='pointer';
      b.textContent=date.toLocaleDateString(undefined,{month:'short',year:'numeric'});
      b.addEventListener('click', ()=>{ let d=new Date(y,m-1, rint(2,26)); const wd=d.getDay(); if(wd===0){d.setDate(d.getDate()+1);} if(wd===6){d.setDate(d.getDate()+2);} renderEdition(d); window.scrollTo({top:0,behavior:"smooth"}); });
      host.appendChild(b);
    }
  }
}

// ==== chips + edition render
function buildChips(){
  const host = document.getElementById('topic-chips'); if(!host) return;
  host.innerHTML='';
  (SECTIONS||[]).forEach(s=>{
    const span=document.createElement('span');
    span.className='badge';
    span.textContent=s.name;
    host.appendChild(span);
  });
}
function renderEdition(dateObj){
  __daySentences.clear();
  const host=qs('#sections'); host.innerHTML='';
  const d=ensureWeekday(dateObj);
  document.getElementById('datestamp').textContent='— '+ new Date().toLocaleDateString(undefined,{year:'numeric',month:'long',day:'numeric'});
  SECTIONS.forEach(sec=>{
    const block=document.createElement('div'); block.style.marginTop='12px';
    block.innerHTML='<h3 class="section-title">'+esc(sec.name)+'</h3>';
    const holder=document.createElement('div'); holder.className='grid';
    block.appendChild(holder); host.appendChild(block);
    const row=document.createElement('div'); row.className='grid posts'; holder.appendChild(row);
    renderSection(row, sec.key, d);
  });
}

// ==== boot
function boot(){
  renderEdition(new Date());
  buildChips();
  buildArchive();
}
if(document.readyState==='loading'){ document.addEventListener('DOMContentLoaded', boot); } else { boot(); }
// ==== disable copy & inspect
document.addEventListener('contextmenu', e => e.preventDefault());
document.addEventListener('keydown', e => {
  if (e.ctrlKey && (e.key === 'u' || e.key === 's' || e.key === 'c')) e.preventDefault();
  if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J'))) e.preventDefault();
});
document.addEventListener('selectstart', e => e.preventDefault());
</script>
</body>
</html>